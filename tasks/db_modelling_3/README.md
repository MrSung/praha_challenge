# DB モデリング３

## 課題１、課題２

課題２：ドキュメント順番機能

- ディレクトリ内のドキュメント順番を変更可能
- 順番はユーザー間でリアルタイム共有可能

> **Note:**
>
> - `directory_path`は、text 形式のスカラ値で用意するのが、一番取り扱いやすいと考えた
>   - `path/to/certain/subdirectory`みたいなスラッシュ区切りの text 形式
> - ドキュメントは論理削除して、別テーブルで削除済みドキュメントを管理する
>   - CREATED-DOCUMENT からレコード削除 → DELETED-DOCUMENT にレコード追加
> - ドキュメントを含まない空ディレクトリは、物理削除する
>   - DIRECTORY-DOCUMENT-RELATIONSHIP との結びつきがなく、DIRECTORY テーブル単体のみに含まれるレコード
> - 索引番号をドキュメントのアトリビュートに持たせる方法は、レコードが増えれば増えるほど更新対象が増えるので、取り入れなかった
> - 前後の相対関係を表すアトリビュート`prev_item`, `next_item`を持たせることで、更新対象のレコードを最小限に抑えられると考えた
>   - Notion で並び替えを行った際のリクエストを参考にした

[![課題１、課題２のER図](https://mermaid.ink/img/pako:eNrtVt1KG0EYfZVlr80L5C4kaw3VRGK8KCyEcXdiFvYnbCZSSYRmpmq0FqRQRexFbRVsrfbCgloUH-Zzo175Ct2fmAz7E6ht73qzuwznnPnOfOdbpiUqlorFtIjtnIbmbWTIpmxmZssTxZLQbqdSVkvI5UtStlwsvRDSgmJjRHAjDMmWpExZyqVyxezslFQoJyNz0qSUhBxuFN55AE-VpMlMOV8szEzkp13uHNYtc75RIZZsRorwVNp_R6UdsZjKFgtl7z2VKWSeSSVXpoY8E2GDfX54PYk_OLCWbAqCUkO2gJqkZtkVTRWmnwuyeHP1odfdvHu1nM_JogdaQDaPM5GBeZiz-TbAEc3ADYKMev_I1QoiPPDu-spZ_9jbPujt0IAxZ1k6RqagNSp9cW8rbQGrPA86G0A_AbsEegR0H9hW77wLnWtPY4lv69CSqtlYIZa9OHAFbBXoZ2DfgH4H1gX29dEewS8JR6gjUovFA313t3cInR2gF8C-AGNAz4AdOBs_na4LXofOSW9r1Tnedrrb4doSspFQ8fjoigOCpTQNbBIOvwb02C0I2B6wU5fi4QXBLyQSu1as0HSyUExcxmPj4oPqNl6o8MqyeLv74-bcO6Q4_YfLrtnUdTSn44fLNU7IdLsTJ_TmN4QSghmlB174hA6pzbo6inp7dni_uxJQozXEdCAyoDEdUSyTjO4M0FP_Y8V_vn5KQvgRH1Cqmo77gx6zKXsPdM8fxaPB9EckiEb0BD699smu0BE_gyHbsVxnZdk5uXgcr_DP8N-l-ikV8vFRsY5HxMdZW7_f2R8mL8bc_8D8eWDEMdHAtoE01b2T-Ocni6SGDSyLafdTxVXU1IkPdqHByEuq5v6XxXQV6Q08JrpBsWYWTWWwEKD615v-6tIvymHuiw)](https://mermaid.live/edit#pako:eNrtVt1KG0EYfZVlr80L5C4kaw3VRGK8KCyEcXdiFvYnbCZSSYRmpmq0FqRQRexFbRVsrfbCgloUH-Zzo175Ct2fmAz7E6ht73qzuwznnPnOfOdbpiUqlorFtIjtnIbmbWTIpmxmZssTxZLQbqdSVkvI5UtStlwsvRDSgmJjRHAjDMmWpExZyqVyxezslFQoJyNz0qSUhBxuFN55AE-VpMlMOV8szEzkp13uHNYtc75RIZZsRorwVNp_R6UdsZjKFgtl7z2VKWSeSSVXpoY8E2GDfX54PYk_OLCWbAqCUkO2gJqkZtkVTRWmnwuyeHP1odfdvHu1nM_JogdaQDaPM5GBeZiz-TbAEc3ADYKMev_I1QoiPPDu-spZ_9jbPujt0IAxZ1k6RqagNSp9cW8rbQGrPA86G0A_AbsEegR0H9hW77wLnWtPY4lv69CSqtlYIZa9OHAFbBXoZ2DfgH4H1gX29dEewS8JR6gjUovFA313t3cInR2gF8C-AGNAz4AdOBs_na4LXofOSW9r1Tnedrrb4doSspFQ8fjoigOCpTQNbBIOvwb02C0I2B6wU5fi4QXBLyQSu1as0HSyUExcxmPj4oPqNl6o8MqyeLv74-bcO6Q4_YfLrtnUdTSn44fLNU7IdLsTJ_TmN4QSghmlB174hA6pzbo6inp7dni_uxJQozXEdCAyoDEdUSyTjO4M0FP_Y8V_vn5KQvgRH1Cqmo77gx6zKXsPdM8fxaPB9EckiEb0BD699smu0BE_gyHbsVxnZdk5uXgcr_DP8N-l-ikV8vFRsY5HxMdZW7_f2R8mL8bc_8D8eWDEMdHAtoE01b2T-Ocni6SGDSyLafdTxVXU1IkPdqHByEuq5v6XxXQV6Q08JrpBsWYWTWWwEKD615v-6tIvymHuiw)

## おまけ

実際に、上記 ER 図に従ったドキュメント管理システムの [working example](https://github.com/MrSung/doc-management) を、別途作っている途中

# DB モデリング３

## 課題１、課題２

課題２：ドキュメント順番機能

- ディレクトリ内のドキュメント順番を変更可能
- 順番はユーザー間でリアルタイム共有可能

> **Note:**
>
> - 作成者は新規作成・削除ができるものとした
> - `directory_path`は、text 形式のスカラ値で用意するのが、一番取り扱いやすいと考えた
>   - `path/to/certain/subdirectory`みたいなスラッシュ区切りの text 形式
> - ドキュメントは論理削除して、別テーブルで削除済みドキュメントを管理する
>   - CREATED-DOCUMENT からレコード削除 → DELETED-DOCUMENT にレコード追加
> - ドキュメントを含まない空ディレクトリは、物理削除する
>   - DIRECTORY-DOCUMENT-RELATIONSHIP との結びつきがなく、DIRECTORY テーブル単体のみに含まれるレコード
> - 索引番号をドキュメントのアトリビュートに持たせる方法は、レコードが増えれば増えるほど更新対象が増えるので、取り入れなかった
> - 前後の相対関係を表すアトリビュート`prev_item`, `next_item`を持たせることで、更新対象のレコードを最小限に抑えられると考えた
>   - Notion で並び替えを行った際のリクエストを参考にした

[![課題１、課題２のER図](https://mermaid.ink/img/pako:eNrtVl1L21AY_ivhXNs_0LvSRCxzbanxYhAox-RoA_ko6alM2sJMZm27DUTYSnEXK1Nwc7oLB86h-GOOqfXKv7A0ydKYnHRTxq52U8Lp8zzv13PepAFEXUIgDZDBynDNgKqgCVpmmV8olJhmM5XSmwzLLXI8x6b80zRTgbX7mAbD5kpcli-Unjl_iwaCGMUg2RKXmciwhezyUy7PJyN_BaQhp4GikQN4qsQtZvhcIb-0kCs63BWk6NparYx1QYsl8fdUms1YialsIc97Bbg9ixXm86LnUV7QoIagMYxYgQYD67iiG2VZYopPGAFcX74fdXbGL7ZyrAAmoHVohHEaVFEYZu-88XARsXmqGJZVVMNQrfpzkMoQh3Hjq0u792HUPxgNzAmjNS11RuK_iyUhBcVj2d3e7WD_fqzAE9MwkmwgEevGRtAiYm0T8yOxvhDzK7E6xPochETPcYhQhbhCxRNzdzw8JJsDYp4T6xOxLGKeEevAfv3D7jjgHtk8Gb3bto_7dqcfzS3BWAkZz8_O2CPoYl1FGg7hu8Q8dhIi1pBYpw7Fw7cojm1QZYqzZP5wgC6oaqD1clhZADd7366_T1pE07-76Gh1RYErCrq76IaENGc2NKFXDxBKsG-c7tUy9VaYWq9Ks6g3Z4e3e22PGs-BMoHgjlMmIeoanj0RYp66D2339-XjfDHdEgFlVVaQvysoQa23xBwSc59YR8ECiUlgGSsJfPPKJTtCR-GbFymbyrXbW_bJeWS5_AM3PybDxCVGIVG2WdLL4L9RHmwUMAdUZKhQlpxPHLd_AsAVpCIBpJ1HCa3CuoJdsAP1rjgnyc4WBulVqNTQHHAMoi9taGJw4KH8ryX_tPUTpA4Kfw)](https://mermaid.live/edit#pako:eNrtVl1L21AY_ivhXNs_0LvSRCxzbanxYhAox-RoA_ko6alM2sJMZm27DUTYSnEXK1Nwc7oLB86h-GOOqfXKv7A0ydKYnHRTxq52U8Lp8zzv13PepAFEXUIgDZDBynDNgKqgCVpmmV8olJhmM5XSmwzLLXI8x6b80zRTgbX7mAbD5kpcli-Unjl_iwaCGMUg2RKXmciwhezyUy7PJyN_BaQhp4GikQN4qsQtZvhcIb-0kCs63BWk6NparYx1QYsl8fdUms1YialsIc97Bbg9ixXm86LnUV7QoIagMYxYgQYD67iiG2VZYopPGAFcX74fdXbGL7ZyrAAmoHVohHEaVFEYZu-88XARsXmqGJZVVMNQrfpzkMoQh3Hjq0u792HUPxgNzAmjNS11RuK_iyUhBcVj2d3e7WD_fqzAE9MwkmwgEevGRtAiYm0T8yOxvhDzK7E6xPochETPcYhQhbhCxRNzdzw8JJsDYp4T6xOxLGKeEevAfv3D7jjgHtk8Gb3bto_7dqcfzS3BWAkZz8_O2CPoYl1FGg7hu8Q8dhIi1pBYpw7Fw7cojm1QZYqzZP5wgC6oaqD1clhZADd7366_T1pE07-76Gh1RYErCrq76IaENGc2NKFXDxBKsG-c7tUy9VaYWq9Ks6g3Z4e3e22PGs-BMoHgjlMmIeoanj0RYp66D2339-XjfDHdEgFlVVaQvysoQa23xBwSc59YR8ECiUlgGSsJfPPKJTtCR-GbFymbyrXbW_bJeWS5_AM3PybDxCVGIVG2WdLL4L9RHmwUMAdUZKhQlpxPHLd_AsAVpCIBpJ1HCa3CuoJdsAP1rjgnyc4WBulVqNTQHHAMoi9taGJw4KH8ryX_tPUTpA4Kfw)

## おまけ

実際に、上記 ER 図に従ったドキュメント管理システムの [working example](https://github.com/MrSung/doc-management) を、別途作っている途中

# DB モデリング３

## 課題１、課題２

課題２：ドキュメント順番機能

- ディレクトリ内のドキュメント順番を変更可能
- 順番はユーザー間でリアルタイム共有可能

> **Note:**
>
> - 作成者は新規作成・削除ができるものとした
> - `directory_path`は、text 形式のスカラ値で用意するのが、一番取り扱いやすいと考えた
>   - `path/to/certain/subdirectory`みたいなスラッシュ区切りの text 形式
> - ドキュメントは論理削除して、別テーブルで削除済みドキュメントを管理する
>   - CREATED-DOCUMENT からレコード削除 → DELETED-DOCUMENT にレコード追加
> - ドキュメントを含まない空ディレクトリは、物理削除する
>   - DIRECTORY-DOCUMENT-RELATIONSHIP との結びつきがなく、DIRECTORY テーブル単体のみに含まれるレコード
> - 索引番号をドキュメントのアトリビュートに持たせる方法は、レコードが増えれば増えるほど更新対象が増えるので、取り入れなかった
> - 前後の相対関係を表すアトリビュート`prev_item`, `next_item`を持たせることで、更新対象のレコードを最小限に抑えられると考えた
>   - Notion で並び替えを行った際のリクエストを参考にした

[![課題１、課題２のER図](https://mermaid.ink/img/pako:eNrtVl1L21AY_ivhXNs_0LvSRCxzbanxYhAox-TUBvJR0lOZtIWZM2vbbSDCVoq7WJmCm9NdOHAOxR9zTK1X_oWlSZfGfHSrjF3tJoST53ner-e8pA5EXUIgCZDBynDdgKqgCVpqlV_KFZhGI5HQGwzLLXM8xyYmp0mmDKsPMXWGzRS4NJ8rPLM_iwaCGIUg6QKXGsuwufTqUy7LxyN_BYxCTgMFI3vwRIFbTvGZXHZlKZO3uWtI0bX1ahHrghZK4u-pNBqhEhPpXJZ3C3B6FipswgueB3leg-qCxjBiGRoMrOGybhRlick_YQRwc_V-2N4dvdjOsAIYgzag4cdpUEV-mLX7xsVhWUVVDNXKpMVSEWI_cHR9ZXU_DHuHw745ZjSnVczIaTEyp9_Fsjrdu_7Bw1jeuKdhJNlAItaNTa96Snao-ZGSL9T8Skmbks9eSPQc-wgViMuReGrujQZHdKtPzQtKPlFCqHlOyaH1-ofVtsFdunU6fLdjnfSsdi-YW4xnYjJenJ2xS9DFmoo07MN3qHliJ0TJgJIzm-LimxFmrEfK5GfJ_OEAHVDFQBtFv7IAbve_3XwftyhK__6yrdUUBa4p6P6y4xPS7NlECb2aQyjGUmG6W8vUW35qrSLNot6eH93tt1xqOIeICXjXN2ISoq7h2ROh5pnz0nKeLx_ni-kC8CglWUGTNRARlLyl5oCaB5Qce7shJIFlrMTwzWuHbAsd-29eoOxIrtXatk4vAsvlH7j5MRnO4biobRa35_8bZW6jgAWgIkOFsmT_vTj9EwAuIxUJIGm_SqgEawp2wDbUveKcJNtbGCRLUKmiBWAbRF_Z1ETvwEVNfoQmp82fLj37aQ)](https://mermaid.live/edit#pako:eNrtVl1L21AY_ivhXNs_0LvSRCxzbanxYhAox-TUBvJR0lOZtIWZM2vbbSDCVoq7WJmCm9NdOHAOxR9zTK1X_oWlSZfGfHSrjF3tJoST53ner-e8pA5EXUIgCZDBynDdgKqgCVpqlV_KFZhGI5HQGwzLLXM8xyYmp0mmDKsPMXWGzRS4NJ8rPLM_iwaCGIUg6QKXGsuwufTqUy7LxyN_BYxCTgMFI3vwRIFbTvGZXHZlKZO3uWtI0bX1ahHrghZK4u-pNBqhEhPpXJZ3C3B6FipswgueB3leg-qCxjBiGRoMrOGybhRlick_YQRwc_V-2N4dvdjOsAIYgzag4cdpUEV-mLX7xsVhWUVVDNXKpMVSEWI_cHR9ZXU_DHuHw745ZjSnVczIaTEyp9_Fsjrdu_7Bw1jeuKdhJNlAItaNTa96Snao-ZGSL9T8Skmbks9eSPQc-wgViMuReGrujQZHdKtPzQtKPlFCqHlOyaH1-ofVtsFdunU6fLdjnfSsdi-YW4xnYjJenJ2xS9DFmoo07MN3qHliJ0TJgJIzm-LimxFmrEfK5GfJ_OEAHVDFQBtFv7IAbve_3XwftyhK__6yrdUUBa4p6P6y4xPS7NlECb2aQyjGUmG6W8vUW35qrSLNot6eH93tt1xqOIeICXjXN2ISoq7h2ROh5pnz0nKeLx_ni-kC8CglWUGTNRARlLyl5oCaB5Qce7shJIFlrMTwzWuHbAsd-29eoOxIrtXatk4vAsvlH7j5MRnO4biobRa35_8bZW6jgAWgIkOFsmT_vTj9EwAuIxUJIGm_SqgEawp2wDbUveKcJNtbGCRLUKmiBWAbRF_Z1ETvwEVNfoQmp82fLj37aQ)

## おまけ

実際に、上記 ER 図に従ったドキュメント管理システムの [working example](https://github.com/MrSung/doc-management) を、別途作っている途中

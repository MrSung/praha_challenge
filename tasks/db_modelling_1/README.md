# DB モデリング１

## 課題１

> **Note:**
>
> - 一つの注文を、各ネタに紐付いた注文明細によって成り立たせる。

[![課題１のER図](https://mermaid.ink/img/pako:eNp9k09v0zAchr-K5XP6BXJDpIMw2kxtd4tUuY63WGrs4NgaUzuJthIMpAou5QIXEBIwpAk0EEhM2oexGthpXwG3TtqwMk7548evHv9eeQAxjwh0IREeRfsCJSEL2e3ddido1FtgOKzV-AAELc98uCDtI0yyyvogZADgGAmEJREAq0zyhIgujcDONgjh5Zv389O3vhfCBSjJQ7lmGErICpm_mFqGMkn2q1FpzBnpMpX0zN8Sv3z18_fHL79mJ_Pn3xf7jkJmHRfCw0K45tU7t_z7xhtzJhFlWUld0-YiqjjnZx_yl09K538fbmvzcD3O-wSxNWZTU8HNyDISrZLzH8d6dFG1LkWX8kPQ3m3f9Y11jLJrwE3eW__zzlQW0xWlJ1M9viipctqWeaAQk1QerrB89rnwtE6DG5J3NpOXXVugKNqubxRtmVRQXIEevctPv1mOmOoLCCOzhYu1nx5_0pPHevxVT06uzo-bQbPugEbQ8reDhu-Apn_Hb5mnFzQdcM9vBJ3g6vzp33UdUBlzJbsHKEM9ukgezfToLH_2Wo-mxeGhA02hCaKRuSjLGYRQxiQhIXTNa0T2kOrLJWxQlUbGsx5RyQV091A_Iw5ESvL2IcPQlUKREiquXEEd_QGioGZu)](https://mermaid.live/edit#pako:eNp9k09v0zAchr-K5XP6BXJDpIMw2kxtd4tUuY63WGrs4NgaUzuJthIMpAou5QIXEBIwpAk0EEhM2oexGthpXwG3TtqwMk7548evHv9eeQAxjwh0IREeRfsCJSEL2e3ddido1FtgOKzV-AAELc98uCDtI0yyyvogZADgGAmEJREAq0zyhIgujcDONgjh5Zv389O3vhfCBSjJQ7lmGErICpm_mFqGMkn2q1FpzBnpMpX0zN8Sv3z18_fHL79mJ_Pn3xf7jkJmHRfCw0K45tU7t_z7xhtzJhFlWUld0-YiqjjnZx_yl09K538fbmvzcD3O-wSxNWZTU8HNyDISrZLzH8d6dFG1LkWX8kPQ3m3f9Y11jLJrwE3eW__zzlQW0xWlJ1M9viipctqWeaAQk1QerrB89rnwtE6DG5J3NpOXXVugKNqubxRtmVRQXIEevctPv1mOmOoLCCOzhYu1nx5_0pPHevxVT06uzo-bQbPugEbQ8reDhu-Apn_Hb5mnFzQdcM9vBJ3g6vzp33UdUBlzJbsHKEM9ukgezfToLH_2Wo-mxeGhA02hCaKRuSjLGYRQxiQhIXTNa0T2kOrLJWxQlUbGsx5RyQV091A_Iw5ESvL2IcPQlUKREiquXEEd_QGioGZu)

### 任意課題

#### 論理設計

必要なデータを全部洗い出して、一事実が一箇所になるように（正規化）、表と表の関係性（リレーション）を組む。
つまり、正規化されたテーブルを設計していき、最後に人が見てもわかるような ER 図に落とし込む。

1. データの洗い出し
2. リレーションの作成
3. 正規化
4. ER 図の作成

#### 物理設計

論理設計で出来上がった ER 図を基に、DBMS (Oracle, SQL Server など) で実装する。

- データ容量の調整
- トランザクション・ログ
- 障害があった時の保証
- インデックスによる検索性の調整
- パフォーマンスの調整

あたりを物理設計で進めていく。

---

## 課題２

- シャリの大小も選べるようにする
  - shari_size の enum を追加。not null 制約を考慮して、デフォルト値を `DEFAULT` に指定
- 寿司ネタが毎月何個売れているのかを知れるようにする
  - セットメニューがどんなネタで構成されているのか用意することで対応

> **Note:**
>
> - セットメニュー単位での注文管理が、より容易にできるように表現する。
> - カラムの重複が大きいが、単品と詰合せで分ける。
> - 各ネタの在庫管理も考慮してみた。

[![課題２のER図](https://mermaid.ink/img/pako:eNq9lktP20AQx7-K5XPyBXKjJKERCUEk3CxFG3shq8a7qb0WpQlSnahq2oJAqqgqwaEPJF5SRIUqqoLKh1k5wImv0I1f8ZO2h_bmXf9m5j87s2N3RZkoUMyJUMsjsKoBVcISnl2u1auVwpLQ62WzpCtUl_J8kRM6bSBDXcLOevKy577M1koLc-VCtlQvVDgoE0wBwsnobLXyqJpChvzYVr14gGx1sV6qLnDrFvANA15DdtP9RLNYvK5QW649LiVIi0ewdzx_zsL1kZKj7TrLD3d2Pj1aApTiLlCproQFQW4BDcgUaoJs6JSoUGsgRVicFyTx7tOhNfpcykviBKTwGZ0yGKjQR6ydLYdBmMLVoKtOi2DYwIba5Lsefrd3eXv89Wb3xNq-mNhteCWPCCKaElAzPj8av3_lqUmWXYzLbhLShgBPMcdrRyO8LXWo-J7H34fMvA7qCRU6UZuO8GobNhCFqq_T2vpgvTMdn3cfX97sjeKa_cyKUYs4qxt6C0VYNthi_WuP9U7dIZ8aAFNE1yPwePcslFugPRJTk4naJOHMWP-SDQZsMPyb5CJGCfVzAkXx5BQdOJBihI9mmTAB_qSQxYcL6fXUGqItYtDGGtBBE03UmLvMPB-_2WemeyMg731B59EQj_Ec2oov2OALG5wwc2QdHFpn2_dXw3yhOLNcrmeE8szSXCEj1Coz5fL91euUkj2YS7hyxd9W7r9n44yvbkqbL6a1uT2AHMydPkEqNoMcsqMhOYa-OBiPvrlinBHcTelJW8zt8Rnrm9bOkPW3mbkXHog26eqJgPGxaMOepCgdU5V4O8PXJUVa2vSI4Mw8tXZOmfmT9TdZ_2380DfCX5Z_XjJK5Cc-ZO0fWT9OpzdazIh8fqsAKfzfw5YiibQFVSiJOf6owBVgtKkNc9ToKIDCgoIo0cTcCmjrMCMCg5LaOpb9DYdyf2Pc3Y1fJluf4g)](https://mermaid.live/edit#pako:eNq9lktP20AQx7-K5XPyBXKjJKERCUEk3CxFG3shq8a7qb0WpQlSnahq2oJAqqgqwaEPJF5SRIUqqoLKh1k5wImv0I1f8ZO2h_bmXf9m5j87s2N3RZkoUMyJUMsjsKoBVcISnl2u1auVwpLQ62WzpCtUl_J8kRM6bSBDXcLOevKy577M1koLc-VCtlQvVDgoE0wBwsnobLXyqJpChvzYVr14gGx1sV6qLnDrFvANA15DdtP9RLNYvK5QW649LiVIi0ewdzx_zsL1kZKj7TrLD3d2Pj1aApTiLlCproQFQW4BDcgUaoJs6JSoUGsgRVicFyTx7tOhNfpcykviBKTwGZ0yGKjQR6ydLYdBmMLVoKtOi2DYwIba5Lsefrd3eXv89Wb3xNq-mNhteCWPCCKaElAzPj8av3_lqUmWXYzLbhLShgBPMcdrRyO8LXWo-J7H34fMvA7qCRU6UZuO8GobNhCFqq_T2vpgvTMdn3cfX97sjeKa_cyKUYs4qxt6C0VYNthi_WuP9U7dIZ8aAFNE1yPwePcslFugPRJTk4naJOHMWP-SDQZsMPyb5CJGCfVzAkXx5BQdOJBihI9mmTAB_qSQxYcL6fXUGqItYtDGGtBBE03UmLvMPB-_2WemeyMg731B59EQj_Ec2oov2OALG5wwc2QdHFpn2_dXw3yhOLNcrmeE8szSXCEj1Coz5fL91euUkj2YS7hyxd9W7r9n44yvbkqbL6a1uT2AHMydPkEqNoMcsqMhOYa-OBiPvrlinBHcTelJW8zt8Rnrm9bOkPW3mbkXHog26eqJgPGxaMOepCgdU5V4O8PXJUVa2vSI4Mw8tXZOmfmT9TdZ_2380DfCX5Z_XjJK5Cc-ZO0fWT9OpzdazIh8fqsAKfzfw5YiibQFVSiJOf6owBVgtKkNc9ToKIDCgoIo0cTcCmjrMCMCg5LaOpb9DYdyf2Pc3Y1fJluf4g)

---

## 課題３

### 考えうる追加仕様

- 支払い方法の追加で、クレカや電子マネー決済が選択できるようにする。
  - customer_order_payment_method の enum を追加

[![課題３のER図](https://mermaid.ink/img/pako:eNq9ls1u2kAQx1_F8hlegBsFk6BAiIAcKllCi70JVrGX2mulKUSqQVVJW5RILVGl5NCPSPmSaKqoSttEzcOs7CSnvEIXG4M_2_TQ3rzr38z8Z2d27DYrIBGyKRaqWQmsqkDmFV7JLFeqpSJXZjqdZBK1mVI5SxcpptUEAtR4xVmPX3YmL5OV_OJcgUvmq1yRggJSMJCUaDRTKj4oxZA-P7ZVJxwgWVqq5kuL1LoBpoYerz672X6kWShem6ksV-bzEdLCEewd15-zmPiIydF2naSHm1mIjxYBxbjzVKrNKwwjNIAKBAxVRtA1jGSo1iSRWVpgePb2w4E5-pjP8uwYxPAJnjEKkOEUMbcHDiMpGK56XbUaSIE1RZfrdNfFb3cvbo6-XA-Pza3zsd2GW_KAIKSKHjXW2aG188JVEy07F5ZdR6gJgTLDHK8tFdG21KA49Wx96xPjyjGCVHHIAqzLUME1GeIGss3efrY2h9bOd-tseHfZz6Qr8wmGqxVLi9zDBJMpc9l8tZZJl7N3l5veNH39E5myJimrTViTMJSn6ZuDd-Ybw5F6-_759e4ofBTTA8sFLcKspmsNKcCS3oB0r1zWLaZDPtaBgiW8HoCt4akvN0_XRaYmILmO_JmR7gXp9Uiv_zfJBYwi2sIJFMSjU3RgT4oBPphlxGC5TyFzvy-k26prEu0wHdfWgAbq0liNMSTGmfVyjxgDT4NqNJpEYzyFtuJz0vtEesfEGJn7B-bpFu3JLJdLLxeqCaaQLs9xCaZSTBcKwXYMT7t7VC73x8r992ycqdiOafOluDa355qDTYaalwqNNodsqZIQQp_tW6OvEzHOZG_H9KQt5ubolHQNc7tPulvE2PXPWZuc6AmA4Wlrw66kIB1SFXk7_dclRlrc9AjgxDgxt0-I8ZN0X5Puq_Chb_g_WP-8ZBgJj6aQuXdo_jiZ3Wg2wdIhLwNJpL80thSexQ0oQ55N0UcRrgC9iW2YonpLBBhyooSRyqZWQFODCRboGFXWFWG64VCTv6PJ7sYvbb7EFQ)](https://mermaid.live/edit#pako:eNq9ls1u2kAQx1_F8hlegBsFk6BAiIAcKllCi70JVrGX2mulKUSqQVVJW5RILVGl5NCPSPmSaKqoSttEzcOs7CSnvEIXG4M_2_TQ3rzr38z8Z2d27DYrIBGyKRaqWQmsqkDmFV7JLFeqpSJXZjqdZBK1mVI5SxcpptUEAtR4xVmPX3YmL5OV_OJcgUvmq1yRggJSMJCUaDRTKj4oxZA-P7ZVJxwgWVqq5kuL1LoBpoYerz672X6kWShem6ksV-bzEdLCEewd15-zmPiIydF2naSHm1mIjxYBxbjzVKrNKwwjNIAKBAxVRtA1jGSo1iSRWVpgePb2w4E5-pjP8uwYxPAJnjEKkOEUMbcHDiMpGK56XbUaSIE1RZfrdNfFb3cvbo6-XA-Pza3zsd2GW_KAIKSKHjXW2aG188JVEy07F5ZdR6gJgTLDHK8tFdG21KA49Wx96xPjyjGCVHHIAqzLUME1GeIGss3efrY2h9bOd-tseHfZz6Qr8wmGqxVLi9zDBJMpc9l8tZZJl7N3l5veNH39E5myJimrTViTMJSn6ZuDd-Ybw5F6-_759e4ofBTTA8sFLcKspmsNKcCS3oB0r1zWLaZDPtaBgiW8HoCt4akvN0_XRaYmILmO_JmR7gXp9Uiv_zfJBYwi2sIJFMSjU3RgT4oBPphlxGC5TyFzvy-k26prEu0wHdfWgAbq0liNMSTGmfVyjxgDT4NqNJpEYzyFtuJz0vtEesfEGJn7B-bpFu3JLJdLLxeqCaaQLs9xCaZSTBcKwXYMT7t7VC73x8r992ycqdiOafOluDa355qDTYaalwqNNodsqZIQQp_tW6OvEzHOZG_H9KQt5ubolHQNc7tPulvE2PXPWZuc6AmA4Wlrw66kIB1SFXk7_dclRlrc9AjgxDgxt0-I8ZN0X5Puq_Chb_g_WP-8ZBgJj6aQuXdo_jiZ3Wg2wdIhLwNJpL80thSexQ0oQ55N0UcRrgC9iW2YonpLBBhyooSRyqZWQFODCRboGFXWFWG64VCTv6PJ7sYvbb7EFQ)

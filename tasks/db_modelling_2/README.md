# 課題

## 課題１

横断機能

- メッセージとスレッドメッセージを横断的に検索できること（例えば「hoge」と検索したら、この文字列を含むメッセージとスレッドメッセージを両方とも取得できること）
- 参加していないチャネルのメッセージ・スレッドメッセージは検索できないこと

> **Note:**
>
> - 投稿されたメッセージ`MESSAGE`に紐付いている、`MESSAGE-THREAD`のメッセージスレッド ID `message_thread_id` は、スレッドの生成の際に用いられる
>   - 同じスレッド内のメッセージは、同じメッセージスレッド ID を持つ
>   - 同じメッセージスレッド ID のうち、メッセージ投稿日時 `message_posted_at` の一番古いものが親メッセージとして用いられる
> - メッセージなど、頻繁に変更が発生するものに関しては、基本は論理削除を想定している
> - ユーザーのワークスペース・チャンネルへの参加・脱退の際は、中間テーブルである`USER-PER-WORKSPACE`と`USER-PER-CHANNEL`から、それぞれ、対象のレコードの追加・物理削除をすることで、結びつきを追加することと、切ることに対応する
>   - チャンネルに表示するメッセージは、メッセージ種別 `message_context` の値を `SYSTEM` に指定することで出し分ける
> - スレッドメッセージは、実際の挙動で確認したところ、親のメッセージを削除しても存在する

[![課題１のER図](https://mermaid.ink/img/pako:eNq1Vd1q1EAYfZVhrndfIHdLN7VSW8OmIkJgmSZfd4PJzJJMUNnthRkUWyh4U0q9E61UlFYQxEXBhxl2i29h_pMmG1oKXiQM853znTNnMpMpNpkFWMHg9W0y8ohrUIM-fjjY1LXemopms26XTdHaRm97W32AFGQyyolNfYM-0tVBXo_HXS16SqaCdsFhdOQPOWsBl12r0Ib4jc3zPrfrX0Nvqbreu6e2Lq2sT5jPo2I-Eddns7ze3dkYqL1-BBsTP84w6TE1KELmmHjE5OChwAdvaFtI20QGluKTFL9l-CN63-8bOIZyeM5TFCUu1ECLt0cxaj_tXUukRWm9TamEPmPeU39CTKjgLxP8pQznUrxLxvOUWBXPg7y7dDSiFJwK-qUUH6T4LsWRFF8KydZlXvOu3eA9i7fkFBmvoJRhtyyz4l1r9X7nnDOvuUjh9JpG6TH_JmseXfB9MqqG814KIcNfidTPpsf_sHe189HucP1WDnMCH3tArJjXICVpfo1nxEHeAGjgFtz4oMfpNphX5xeLN2dKcoN0kP5E31G3KruR8Zu8xetXi4t5hrQjGCfupJCL7w2whmSF4PLw-Or8z_LkbHkapvRdxhwgFNn-MOdb4EDUYIXsweHf049SHEvxWYbfssBxB7vgucS2oms9idvAfAwuGFiJhhbskcDhCTiCBhOLcFAtmzMPK3vE8aGDScCZ_oKaxUSKyv4Q2ez-P00VlHs)](https://mermaid.live/edit#pako:eNq1Vd1q1EAYfZVhrndfIHdLN7VSW8OmIkJgmSZfd4PJzJJMUNnthRkUWyh4U0q9E61UlFYQxEXBhxl2i29h_pMmG1oKXiQM853znTNnMpMpNpkFWMHg9W0y8ohrUIM-fjjY1LXemopms26XTdHaRm97W32AFGQyyolNfYM-0tVBXo_HXS16SqaCdsFhdOQPOWsBl12r0Ib4jc3zPrfrX0Nvqbreu6e2Lq2sT5jPo2I-Eddns7ze3dkYqL1-BBsTP84w6TE1KELmmHjE5OChwAdvaFtI20QGluKTFL9l-CN63-8bOIZyeM5TFCUu1ECLt0cxaj_tXUukRWm9TamEPmPeU39CTKjgLxP8pQznUrxLxvOUWBXPg7y7dDSiFJwK-qUUH6T4LsWRFF8KydZlXvOu3eA9i7fkFBmvoJRhtyyz4l1r9X7nnDOvuUjh9JpG6TH_JmseXfB9MqqG814KIcNfidTPpsf_sHe189HucP1WDnMCH3tArJjXICVpfo1nxEHeAGjgFtz4oMfpNphX5xeLN2dKcoN0kP5E31G3KruR8Zu8xetXi4t5hrQjGCfupJCL7w2whmSF4PLw-Or8z_LkbHkapvRdxhwgFNn-MOdb4EDUYIXsweHf049SHEvxWYbfssBxB7vgucS2oms9idvAfAwuGFiJhhbskcDhCTiCBhOLcFAtmzMPK3vE8aGDScCZ_oKaxUSKyv4Q2ez-P00VlHs)
